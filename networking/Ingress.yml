#  \
#  \\,
#   \\\,^,.,,.                     Zero to Hero
#   ,;7~((\))`;;,,               <zerotohero.dev>
#   ,(@') ;)`))\;;',    stay up to date, be curious: learn
#    )  . ),((  ))\;,
#   /;`,,/7),)) )) )\,,
#  (& )`   (,((,((;( ))\,


---
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: cerberus
  annotations:
    kubernetes.io/ingress.class: alb
    alb.ingress.kubernetes.io/target-type: ip
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/healthcheck-path: /healthz
    alb.ingress.kubernetes.io/certificate-arn: arn:aws:acm:us-west-2:340111760086:certificate/45330a0a-dbae-41a9-a111-13ed2220cf5b
    alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}, {"HTTPS":443}]'
    alb.ingress.kubernetes.io/actions.ssl-redirect: '{"Type": "redirect", "RedirectConfig": { "Protocol": "HTTPS", "Port": "443", "StatusCode": "HTTP_301"}}'
spec:
  rules:
  - host: api.fizzbuzz.pro
    http:
      paths:
      # This is for testing purposes only.
      # Once everything is working properly disable this crypto endpoint.
      # Same goes for mailer. It is for private consumption.
      # Ideally we should secure them with private service roles / tokens too
      # while making an API request.
      # - backend:
      #     serviceName: crypto
      #     servicePort: 80
      #   path: /crypto/*
      - backend:
          serviceName: idm
          servicePort: 80
        path: /idm/*
      - backend:
          serviceName: questions
          servicePort: 80
        path: /questions/*
      - backend:
          serviceName: store
          servicePort: 80
        path: /store/*
